NGUSERNAME [a-zA-Z\.\@\-\+_%]+
NGUSER %{NGUSERNAME}
NGINXACCESS %{IPORHOST:clientip} %{NGUSER:ident} %{NGUSER:auth} \[%{HTTPDATE:timestamp}\] "%{WORD:verb} %{URIPATHPARAM:request} HTTP/%{NUMBER:httpversion}" %{NUMBER:response} (?:%{NUMBER:bytes}|-) (?:"(?:%{URI:referrer}|-)"|%{QS:referrer}) %{QS:agent} %{BASE10NUM:request_duration} (?:%{BASE10NUM:upstream_duration}|-) (?:%{BASE10NUM:upstream_connect_time}|-) (?:%{BASE10NUM:upstream_header_time}|-) (?:%{NUMBER:upstream_response}|-) "(?:%{WORD:api_user}|-)" "(?:%{WORD:api_real_user}|-)"
NGINX_ACCESS_LOG %{IP:clientIP} (?:-|(%{WORD}.%{WORD})) %{USER:ident} \[%{HTTPDATE:timestamp}\] "(?:%{WORD:Method} %{NOTSPACE:request_uri}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})" %{NUMBER:status_code} %{NUMBER:bytes_sent} %{QS:referrer} %{QS:user_agent} (?:%{NUMBER:request_time:float}|-) (?:%{NUMBER:upstream_response_time}|-) (?:%{NUMBER:upstream_connect_time}|-) (?:%{NUMBER:upstream_header_time}|-) (?:%{NUMBER:upstream_status}|-) (?:%{WORD:remote_user}|-) %{QS:remote_real_user}
